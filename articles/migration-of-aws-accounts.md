---
title: "AWSアカウントを移行する際にやったことまとめ"
emoji: "🐳"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["AWS", "terraform"]
published: false
---

## 1. はじめに

最近アサインされたプロジェクトで、理由は記載できませんが、 AWS アカウントの廃止が決定し、新しいアカウントへの移行を進めることになりました。旧アカウントの現状を詳しく確認していくと、リソースの管理において以下のような問題を抱えていることが分かりました。

- リソースの作成者や作成時期、作成意図が不明確な状態となっていました
- リソースの命名規則に一貫性がなく、管理が困難な状況でした
- サーバーがパブリックサブネット上に配置されており、セキュリティリスクが存在していました
- データベースなどの重要なリソースが暗号化されていない状態でした
- IAM が複数のアカウントに分散して存在しており、権限管理の透明性が損なわれていました

本記事では、これらの課題を解決しながら、新環境への移行作業で実施した内容について詳しく説明していきます。既存環境の問題点を改善しつつ、より安全で管理しやすい AWS 環境を構築するための取り組みをまとめています。

## 2. AWS Oraganizations の導入

スタンドアロンなアカウントが複数存在していたので、移行にあたり、まず AWS Organizations を導入するところから着手しました。AWS Organizations は、複数の AWS アカウントを一元管理するためのサービスです。

組織内のアカウントは「管理アカウント」と「メンバーアカウント」の2種類に分別され、「管理アカウント」とは、 Organization を作成するためのアカウントのことで、それ以外を「メンバーアカウント」と呼びます。管理アカウントは、メンバーアカウントで発生した料金を支払う責任を持ちます。

:::message alert
管理アカウントを変更することはできないので注意が必要です。

さらに、管理アカウント内でのリソース作成は避けるべきです。これは、サービス制御ポリシー（SCP）が管理アカウント内のリソースには適用されないためです。
:::

### Organization の設計

Organization の設計はこちらの記事を参考にしました。

https://aws.amazon.com/jp/blogs/mt/multi-account-strategy-for-small-and-medium-businesses/