---
title: "Terraformã®æ–°æ©Ÿèƒ½movedã‚’è©¦ã—ã¦ã¿ãŸ"
emoji: "ğŸ£"
type: "tech"
topics: ["terraform"]
published: false
---

## ã“ã®è¨˜äº‹ã¯ï¼Ÿï¼Ÿ

å¾“æ¥ã®Terraformã§ã¯ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ãŸæ™‚ã‚„ãƒªã‚½ãƒ¼ã‚¹ã®å‘½åã‚’å¤‰æ›´ã—ãŸéš›ã¯ã€
ç›´æ¥ `tfstate` ã‚’ç·¨é›†ã—ãªã‘ã‚Œã°ãªã‚‰ãšã›ã£ã‹ããƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã—ã¦ã„ã¦ã‚‚
`tfstate` ã®å¤‰æ›´ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†å¤–ã§å®Ÿæ–½ã—ãªã‘ã‚Œã°ã„ã‘ãªã„ã¨ã„ã†èª²é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚
(ãƒªã‚½ãƒ¼ã‚¹ã®å¤‰æ›´æ‰‹é †ã¯[ã“ã¡ã‚‰](https://zenn.dev/machamp/articles/modify-terraform-resource-name)ã«ã¾ã¨ã‚ã¦ã‚ã‚Šã¾ã™ã€‚)

## ã“ã®è¨˜äº‹ã®ç›®çš„

ã“ã®è¨˜äº‹ã§ã¯Terraform version1.1ç³»ã§æ–°ã—ãè¿½åŠ ã•ã‚ŒãŸ `moved` ã‚’ä½¿ã£ã¦
æ—¢å­˜ã®æ§‹é€ ã«å¤‰æ›´ã‚’åŠ ãˆã‚‹ã“ã¨ã‚‚ `tfstate` ã‚’æ‰‹å‹•ã§å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚ãªãã€
ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚„ãƒªã‚½ãƒ¼ã‚¹ã®å‘½åå¤‰æ›´ãŒå®Ÿæ–½å‡ºæ¥ã‚‹ã“ã¨ã‚’è©¦ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

## æ‰‹é †

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯[ã“ã¡ã‚‰](https://github.com/machamp0714/terraform-move)

### resourceã‚’ä½œã‚‹

```hcl
resource "aws_vpc" "example" {
  cidr_block = "10.0.0.0/16"
}

resource "aws_subnet" "example" {
  vpc_id            = aws_vpc.example.id
  availability_zone = "ap-northeast-1a"
  cidr_block        = "10.0.1.0/24"
}

resource "aws_security_group" "example" {
  name   = "http_sg"
  vpc_id = aws_vpc.example.id

  ingress {
    from_port   = 80
    to_port     = 80
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }

  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }
}

output "vpc_id" {
  value = aws_vpc.example.id
}
```
ã¾ãšã¯ã“ã®æ§˜ã«VPCã€ã‚µãƒ–ãƒãƒƒãƒˆã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’resourceã‚’ä½¿ã£ã¦ä½œæˆã—ã¾ã™ã€‚
applyå¾Œã€æ¬¡ã¯moduleã‚’ä½¿ã£ã¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¦ã¿ã¾ã™ã€‚
